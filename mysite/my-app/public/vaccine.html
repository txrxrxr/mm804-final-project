<!DOCTYPE html>
<html style="height: 100%;width: 100%">
    <head style="width: 100%">
        <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/smalot-bootstrap-datetimepicker/2.4.4/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
        <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
        <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <nav class="navbar navbar-inverse navbar-static-top" role="navigation">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">
                    <span class="glyphicon glyphicon-fire"></span> Covid</a>
            </div>
            <div>
                <ul class="nav navbar-nav">
                    <li><a href="./confirmed.html" id="confirmed">Confirmed Map</a></li>
                    <li><a href="./Death.html" id="death">Death Map</a></li>
                    <li><a href="./Recovered.html" id="recovered">Recovered Map</a></li>
                    <li class="active"><a href="" id="vaccine">Vaccination</a></li>
                </ul>
            </div>
            <!-- <div style="margin-right: 1%" >
            <div class="navbar-form navbar-right">
            <div class="col-md-7">
                <div id="date2ID" class="input-group">
                    <div class="input-group-addon">
                        <i class="fa fa-clock-o" aria-hidden="true"></i>
                    </div>
                    <input id="dateID" class="form-control" value="Select Date" readonly>
                    <div class="input-group-addon">
                        <i class="fa fa-calendar" aria-hidden="true"></i>
                    </div>
                </div>
                
            </div>
            <div class="col-md-2">
                <button type="button" id="SearchBtn" class="btn btn-default"><span class="glyphicon glyphicon-cloud-download"></span>
                Search</button>
            </div>
        </div>
        </div> -->
        </nav>
        <style>
            body{
                max-width:100%;
            }
            .navbar-default{
                max-width:100%;
            }
        </style>
    </head>
    <body style="height: 100%;width: 100%;overflow-x: hidden;overflow-y: hidden">

        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
        <script type="text/javascript" src="world.js"></script>
        <script src="https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
        <script src="https://cdn.bootcss.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <script src="https://cdn.bootcss.com/smalot-bootstrap-datetimepicker/2.4.4/js/bootstrap-datetimepicker.min.js"></script>
        <script src="https://cdn.bootcss.com/smalot-bootstrap-datetimepicker/2.4.4/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
        <!-- Uncomment this line if you want to dataTool extension
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/extension/dataTool.min.js"></script>
        -->
        <!-- Uncomment this line if you want to use gl extension
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
        -->
        <!-- Uncomment this line if you want to echarts-stat extension
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
        -->
        <!-- Uncomment this line if you want to use map
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/map/js/china.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/map/js/world.js"></script>
        -->

        <style type="text/css">
            .navbar { margin-bottom: 0}
        </style>

        <div id="container" style="height: 100%;margin-bottom: 0;position: relative;z-index: 1"></div>


        <script type="text/javascript">

            // $(function() {
            //             $(".form-control").datetimepicker({
            //                 format : 'yyyy-mm-dd', // 展现格式

            //                 startDate : "2020-01-21",// 开始时间
            //                 endDate : "2021-03-31", // 结束时间
            //                 autoclose : true, // 选择日期后关闭
            //                 // 选择器打开之后首先显示的视图
            //                 // 0表示分钟(默认),1表示小时,2表示天,3表示月,4表示年
            //                 startView : 3,
            //                 // 选择器所能够提供的最精确的时间选择视图
            //                 // 0表示分钟(默认),1表示小时,2表示天,3表示月,4表示年
            //                 minView : 2,
            //                 language : 'en-US', //显示语言为中文
            //             });
                        
            //         });

var vaccineArr = [];

    $.ajax({
                type: "GET",
                async: false,
                url: "./vaccinations.json",
                dataType: "json",
                success: function(res) {
                    vaccineArr = res;
        //console.log(confirmedArr);
                }
            });
    //console.log(confirmedArr);


            var dom = document.getElementById("container");
            var myChart = echarts.init(dom);
            var regionData=[];
            var max = 0;
            for(var i = 0; i<vaccineArr.length;i++)
            {
                len = vaccineArr[i]['data'].length;
                regionData.push({"name":vaccineArr[i]["country"],"value":vaccineArr[i]['data'][len-1]['total_vaccinations']});
                if(max<vaccineArr[i]['data'][len-1]['total_vaccinations']){
                    max = vaccineArr[i]['data'][len-1]['total_vaccinations'];
                }
            }

            

            option = {
                visualMap: {
                    show: false,
                    min: 0,
                    max: max,
                    inRange: {
                        color: ['#FFFFFF', '#FFFF99', ' #FFFF00', '#FFCC00', '#FF9900', '#FF6600', '#FF3300', '#FF0000', '#EA0000', '#CE0000', '#AE0000']
                    }
                },
                tooltip: {
                    trigger: 'item',
                    formatter(params) {
                        console.log(params);
                        var info ='';
                        for(var i=0; i<vaccineArr.length; i++){
                            if(vaccineArr[i]['country']==params.data['name'])
                            {
                                info = info + params.data['name']+ "<br>";
                                len = vaccineArr[i]['data'].length;
                                arr = Object.keys(vaccineArr[i]['data'][len-1]);
                                for(var j=0; j<arr.length; j++){
                                    info = info + Object.keys(vaccineArr[i]['data'][len-1])[j] + ": " + vaccineArr[i]['data'][len-1][Object.keys(vaccineArr[i]['data'][len-1])[j]]+ "<br>";
                                } 
                                return info;
                            }
                        }
                        return 'No data';
                        // return info;
                        // return params.data['name']+ " <br> " +"Value: "+ params.data['value'];
                    }
                },
                series: [{
                    type: 'map',
                    map: 'world',
                    postEffect: {
                        enable: true,
                        colorCorrection: {
                            lookupTexture: '/asset/get/s/data-1497261115431-B1XrEJ2f-.jpg'
                        }
                    },
                    light: {
                        main: {
                            intensity: 1,
                            shadow: true,
                            alpha: 150,
                            beta: 70
                        },
                        ambient: {
                            intensity: 0
                        },
                        ambientCubemap: {
                            diffuseIntensity: 1,
                            texture: '/asset/get/s/data-1497251035660-HkVJTnsMW.hdr'
                        }

                    },
                    groundPlane: {
                        show: true
                    },
                    data: regionData
                }]

            };


            if (option && typeof option === 'object') {
                myChart.setOption(option);
            }

        </script>

    </body>
</html>
    